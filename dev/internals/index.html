<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · BraketSimulator.jl</title><meta name="title" content="Internals · BraketSimulator.jl"/><meta property="og:title" content="Internals · BraketSimulator.jl"/><meta property="twitter:title" content="Internals · BraketSimulator.jl"/><meta name="description" content="Documentation for BraketSimulator.jl."/><meta property="og:description" content="Documentation for BraketSimulator.jl."/><meta property="twitter:description" content="Documentation for BraketSimulator.jl."/><meta property="og:url" content="github.com/amazon-braket/BraketSimulator.jl/internals/"/><meta property="twitter:url" content="github.com/amazon-braket/BraketSimulator.jl/internals/"/><link rel="canonical" href="github.com/amazon-braket/BraketSimulator.jl/internals/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BraketSimulator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../sims/">Simulators</a></li><li><a class="tocitem" href="../gates/">Gates</a></li><li><a class="tocitem" href="../custom_gates/">Custom Gates</a></li><li><a class="tocitem" href="../noises/">Noises</a></li><li><a class="tocitem" href="../observables/">Observables</a></li><li><a class="tocitem" href="../results/">Results</a></li><li class="is-active"><a class="tocitem" href>Internals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="github.com/amazon-braket/BraketSimulator.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h1><p>These functions are for internal use for preparing IRs for simulation and validating properties to make sure all instructions and results are supported.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator._combine_operations" href="#BraketSimulator._combine_operations"><code>BraketSimulator._combine_operations</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_combine_operations(program, shots::Int) -&gt; Program</code></pre><p>Combine explicit instructions and basis rotation instructions (if necessary). Validate that all operations are performed on qubits within <code>qubit_count</code>.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator._prepare_program" href="#BraketSimulator._prepare_program"><code>BraketSimulator._prepare_program</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_prepare_program(circuit_ir::OpenQasmProgram, inputs::Dict{String, &lt;:Any}, shots::Int) -&gt; (Program, Int)</code></pre><p>Parse the OpenQASM3 source, apply any <code>inputs</code> provided for the simulation, and compute basis rotation instructions if running with non-zero shots. Return the <code>Program</code> after parsing and the qubit count of the circuit.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section><section><div><pre><code class="language-julia hljs">_prepare_program(circuit_ir::Program, inputs::Dict{String, &lt;:Any}, shots::Int) -&gt; (Program, Int)</code></pre><p>Apply any <code>inputs</code> provided for the simulation. Return the <code>Program</code> (with bound parameters) and the qubit count of the circuit.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator._get_measured_qubits" href="#BraketSimulator._get_measured_qubits"><code>BraketSimulator._get_measured_qubits</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_get_measured_qubits(program, qubit_count::Int) -&gt; Vector{Int}</code></pre><p>Get the qubits measured by the program. If <a href="../circuits/#BraketSimulator.Measure"><code>Measure</code></a> instructions are present in the program&#39;s instruction list, their targets are used to form the list of measured qubits. If not, all qubits from 0 to <code>qubit_count-1</code> are measured. </p></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator._compute_results" href="#BraketSimulator._compute_results"><code>BraketSimulator._compute_results</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_compute_results(::, simulator, program::Program, n_qubits::Int, shots::Int) -&gt; Vector{ResultTypeValue}</code></pre><p>Compute the results once <code>simulator</code> has finished applying all the instructions. The results depend on the IR type if <code>shots&gt;0</code>:</p><ul><li>For JAQCD IR (<code>Program</code>), the results array is <em>empty</em> because the Braket SDK computes the results from the IR directly.</li><li>For OpenQASM IR (<code>OpenQasmProgram</code>), the results array is <em>empty</em> only if no results are present in the parsed IR. Otherwise, the results array is populated with the parsed result types (to help the Braket SDK compute them from the sampled measurements) and a placeholder zero value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator.flip_bit" href="#BraketSimulator.flip_bit"><code>BraketSimulator.flip_bit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flip_bit(amp_index::Integer, bit::Integer)</code></pre><p>Flip the <code>bit</code>-th bit of <code>amp_index</code>, so that 0 becomes 1 and 1 becomes 0. The first valid value of <code>bit</code> is <strong>zero</strong>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; amp_index = 10
10

julia&gt; digits(amp_index, base=2, pad=6)
6-element Vector{Int64}:
 0
 1
 0
 1
 0
 0

julia&gt; amp_index = BraketSimulator.flip_bit(amp_index, 1)
8

julia&gt; digits(amp_index, base=2, pad=6)
6-element Vector{Int64}:
 0
 0
 0
 1
 0
 0</code></pre></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator.flip_bits" href="#BraketSimulator.flip_bits"><code>BraketSimulator.flip_bits</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flip_bits(amp_index::Integer, to_flip)</code></pre><p>Flip the <code>bit</code>-th bit of <code>amp_index</code> for every <code>bit</code> in <code>to_flip</code>, so that 0 becomes 1 and 1 becomes 0. The first valid value of <code>bit</code> is <strong>zero</strong>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; amp_index = 10
10

julia&gt; digits(amp_index, base=2, pad=6)
6-element Vector{Int64}:
 0
 1
 0
 1
 0
 0

julia&gt; amp_index = BraketSimulator.flip_bits(amp_index, (1, 3, 2))
4

julia&gt; digits(amp_index, base=2, pad=6)
6-element Vector{Int64}:
 0
 0
 1
 0
 0
 0</code></pre></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator.pad_bit" href="#BraketSimulator.pad_bit"><code>BraketSimulator.pad_bit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pad_bit(amp_index::Integer, bit::Integer)</code></pre><p>Insert a <code>0</code> at location <code>bit</code> of <code>amp_index</code> (in its bits representation). The first valid value of <code>bit</code> is <strong>zero</strong>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; amp_index = 10
10

julia&gt; digits(amp_index, base=2, pad=6)
6-element Vector{Int64}:
 0
 1
 0
 1
 0
 0

julia&gt; amp_index = BraketSimulator.pad_bit(amp_index, 2);

julia&gt; digits(amp_index, base=2, pad=7)
7-element Vector{Int64}:
 0
 1
 0
 0
 1
 0
 0</code></pre></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator.pad_bits" href="#BraketSimulator.pad_bits"><code>BraketSimulator.pad_bits</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pad_bits(amp_index::Integer, to_pad)</code></pre><p>Insert a <code>0</code> in <code>amp_index</code> at each location <code>bit</code> in the collection <code>to_pad</code>. The first valid value of any <code>bit</code> is <strong>zero</strong>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; amp_index = 10
10

julia&gt; digits(amp_index, base=2, pad=6)
6-element Vector{Int64}:
 0
 1
 0
 1
 0
 0

julia&gt; amp_index = BraketSimulator.pad_bits(amp_index, (2, 4));

julia&gt; digits(amp_index, base=2, pad=8)
8-element Vector{Int64}:
 0
 1
 0
 0
 0
 1
 0
 0</code></pre><div class="admonition is-info" id="Note-6e452a961e3859e7"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-6e452a961e3859e7" title="Permalink"></a></header><div class="admonition-body"><p>The indices in <code>pad_bits</code> aren&#39;t adjusted based on previous indices – this can be seen in the above example, where the bit at index 4 is different <strong>before</strong> and <strong>after</strong> inserting a bit at index 2.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator.matrix_rep" href="#BraketSimulator.matrix_rep"><code>BraketSimulator.matrix_rep</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">matrix_rep(g::Gate)</code></pre><p>Convert <code>g</code> into its matrix form, applying its argument values and any exponent it is raised to.</p></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator.endian_qubits" href="#BraketSimulator.endian_qubits"><code>BraketSimulator.endian_qubits</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">endian_qubits(n_qubits::Int, qubit::Int)</code></pre><p>Rotate the qubit index <code>qubit</code> to match what Braket expects with the correct endianness. This has to be done because Braket and Julia have different <a href="https://en.wikipedia.org/wiki/Endianness">endianness</a>.</p><div class="admonition is-info" id="Note-9a03feb8888f4b53"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-9a03feb8888f4b53" title="Permalink"></a></header><div class="admonition-body"><p>The first valid value for <code>qubit</code> is <strong>zero</strong>, since qubits are zero-indexed.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; qubit = 2
2

julia&gt; n_qubits = 5
5

julia&gt; BraketSimulator.endian_qubits(n_qubits, qubit)
2

julia&gt; qubit = 3
3

julia&gt; BraketSimulator.endian_qubits(n_qubits, qubit)
1</code></pre></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section><section><div><pre><code class="language-julia hljs">endian_qubits(n_qubits::Int, qubits::Int...)</code></pre><p>Rotate each qubit index in <code>qubits</code> to match what Braket expects with the correct endianness. This has to be done because Braket and Julia have different <a href="https://en.wikipedia.org/wiki/Endianness">endianness</a>.</p><div class="admonition is-info" id="Note-b11a2edcbd730bd8"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-b11a2edcbd730bd8" title="Permalink"></a></header><div class="admonition-body"><p>The first valid value for any element of <code>qubits</code> is <strong>zero</strong>, since qubits are zero-indexed.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BraketSimulator.get_amps_and_qubits" href="#BraketSimulator.get_amps_and_qubits"><code>BraketSimulator.get_amps_and_qubits</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_amps_and_qubits(state_vec::AbstractStateVector, qubits::Int...)</code></pre><p>Get the total number of amplitudes of <code>state_vec</code> (its length) and use this to apply <a href="#BraketSimulator.endian_qubits"><code>endian_qubits</code></a> to <code>qubits</code>. This is a convenience function to automate several common operations.</p><div class="admonition is-info" id="Note-b11a2edcbd730bd8"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-b11a2edcbd730bd8" title="Permalink"></a></header><div class="admonition-body"><p>The first valid value for any element of <code>qubits</code> is <strong>zero</strong>, since qubits are zero-indexed.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="github.com/amazon-braket/BraketSimulator.jl">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../results/">« Results</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 2 October 2025 00:30">Thursday 2 October 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
